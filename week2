For this project, it is recommended that you use the  virtual environment provided with the Course package and the tools therein. 
You may also use your own system and software, however make sure that appropriate versions are installed. The answers are compatible with the following versions of the software: samtools v.1.2, bedtools v.2.24.0. 

As part of a larger project cataloging genetic variation in the plant Arabidopsis thaliana, you sequenced and assembled the genome of one strain (‘wu_0_A’), then mapped back the reads to the assembled genome. 
The resulting BAM file is included in the package ‘gencommand_proj2_data.tar.gz’. Using SAMtools and BEDtools as well as other Unix commands introduced in this course, examine the files and answer the following questions. 
NOTE: Input data have been obtained and modified from those generated by the 1001 Genomes Project, accession ‘Wu_0_A’. 

1. How many alignments does the set contain?
samtools view athal_wu_0_A.bam | cut –f3 | grep –v ’*’ | wc -l
## 221372

2. How many alignments show the read's mate unmapped?
samtools view athal_wu_0_A.bam | cut –f7 | grep –c ‘*’
## 65521 

3. How many alignments contain a deletion (D)?
samtools view athal_wu_0_A.bam | cut –f6 | grep –c ‘D’
## 2451

4. How many alignments show the read's mate mapped to the same chromosome?
samtools view athal_wu_0_A.bam | cut –f7 | grep –c ‘=’
## 150913

5. How many alignments are spliced?
samtools view athal_wu_0_A.bam | cut –f6 | grep –c ‘N’
## 0

6. How many alignments does the set contain?
Answer: 7081 ()
## 7081

7. How many alignments show the read's mate unmapped?
samtools view athal_wu_0_A.region.bam | cut –f7 | grep –c ‘*’
## 1983

8. How many alignments contain a deletion (D)?
samtools view athal_wu_0_A.region.bam | cut –f6 | grep –c ‘D’
## 31

9. How many alignments show the read's mate mapped to the same chromosome?
samtools view athal_wu_0_A.bam | cut –f7 | grep –c ‘=’
## 4670

Q10. How many alignments are spliced?
samtools view athal_wu_0_A.bam | cut –f6 | grep –c ‘N’
## 0

Q11. How many sequences are in the genome file?
samtools view –H athal_wu_0_A.bam | grep –c “SN:”
## 7

Q12. What is the length of the first file secuence in the genome file?
samtools view –H athal_wu_0_A.bam | grep “SN:” | more
## 29923332

Q13. What alignment tool was used?
samtools view –H athal_wu_0_A.bam | grep “^@PG”
## stampy

Q14. What is the read identifier (name) for the first alignment?
## GAii05_0002:1:113:7822:3886#0 ()

Q15. What is the start position of this read’s mate on the genome? Give this as ‘chrom:pos’ if the read was mapped, or ‘*” if unmapped.
## Chr3:11700332 ()

Q16. How many overlaps (each overlap is reported on one line) are reported?
bedtools intersect –abam athal_wu_0_A.region.bam –b athal_wu_0_A_annot.gtf –bed -wo > overlaps.bed
## 3101 

Q17. How many of these are 10 bases or longer?
cut –f22 overlaps.bed | sort –nrk1 > lengths
## 2899

Q18. How many alignments overlap the annotations?
cut –f1-12 overlaps.bed | sort –u | wc -l
## 3101

Q19. Conversely, how many exons have reads mapped to them?
cut –f13-21 overlaps.bed | sort –u | wc -l
## 21
Q20. If you were to convert the transcript annotations in the file “athal_wu_0_A_annot.gtf” into BED format, how many BED records would be generated?
cut –f9 athal_wu_0_A.annot.gtf | cut –d ‘ ‘ –f1,2 | sort –u | wc -l
## 4
